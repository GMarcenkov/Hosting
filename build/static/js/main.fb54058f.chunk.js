(this["webpackJsonpipon-web-school"]=this["webpackJsonpipon-web-school"]||[]).push([[0],{158:function(n,e,t){n.exports=t(159)},159:function(n,e,t){t(160).config();var r=t(76),o=t(161),s=t(368);o.load().then((function(){s.success("Server is running on port: "+r.vars.SERVER_PORT)}))},161:function(n,e,t){"use strict";var r=t(52),o=t(77),s=t(334),i=t(346),u=t(78),a=t(76),c=o();c.use(s()),c.use(u.urlencoded({extended:!1})),c.use(u.json()),c.use(i()),a.isDevelopment&&c.use(o.static("public")),n.exports={app:c,beforeLoad:function(){return new Promise((function(n){return n(c)}))},load:function(){return new Promise((function(n){var e=c.listen(a.vars.SERVER_PORT,(function(){return n(c)}));r.connect(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).ATLAS_URI,{useNewUrlParser:!0,useCreateIndex:!0,useUnifiedTopology:!0}),r.connection.once("open",(function(){console.log("MongoDB database connection established successfully")}));var s=t(347);c.use("/api/v1/users",s),c.use(o.static("build")),e.setTimeout(Number(a.vars.SERVER_TIMEOUT))}))}}},189:function(n,e){},190:function(n,e){},194:function(n,e){},196:function(n,e){},235:function(n,e){},240:function(n,e){function t(n){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}t.keys=function(){return[]},t.resolve=t,n.exports=t,t.id=240},242:function(n,e){},244:function(n,e){},276:function(n,e){},277:function(n,e){},347:function(n,e,t){var r=t(77).Router(),o=t(348),s=t(349);t(350);r.route("/").get((function(n,e){o.find().then((function(n){return e.json(n)})).catch((function(n){return e.status(400).json("Error: "+n)}))})),r.route("/add").post((function(n,e){var t=n.body.username,r=n.body.password,s=n.body.name,i=n.body.secondName,u=n.body.familyName,a=n.body.email,c=n.body.phone,d=n.body.isAdmin,f=new o({username:t,password:r,name:s,secondName:i,familyName:u,email:a,phone:c,isAdmin:d});f.save().then((function(){return e.json(f)})).catch((function(n){e.status(400).json("Error: "+n)}))})),r.route("/:id").get((function(n,e){o.findById(n.params.id).then((function(n){return e.json(n)})).catch((function(n){return e.status(400).json("Error: "+n)}))})),r.route("/grade/:userId").get((function(n,e){var t=[];o.findById(n.params.userId).then((function(n){Promise.all(n.schoolYears.map((function(n){return s.findById(n).then((function(n){t.push(n)}))}))).then((function(){return e.json(t)}))})).catch((function(n){return e.status(400).json("Error: "+n)}))})),r.route("/username/:username").get((function(n,e){var t=[];o.find().then((function(r){r.map((function(e){e.username.includes(n.params.username)&&t.push(e)})),e.json(t)})).catch((function(n){return e.status(400).json("Error: "+n)}))})),r.route("/delete/:id").delete((function(n,e){o.findByIdAndDelete(n.params.id).then((function(){return e.json("User deleted.")})).catch((function(n){return e.status(400).json("Error: "+n)}))})),r.route("/edit/:id").put((function(n,e){o.findById(n.params.id).then((function(t){t.username=n.body.username,t.password=n.body.password,t.schoolYears.push(n.body.year),t.date=Date.parse(n.body.date),t.save().then((function(){return e.json("User updated!")})).catch((function(n){return e.status(400).json("Error: "+n)}))})).catch((function(n){return e.status(400).json("Error: "+n)}))})),r.route("/addSchoolYear/:id").put((function(n,e){o.findById(n.params.id).then((function(t){t.schoolYears.push(n.body.schoolYear),t.save().then((function(){return e.json("User's schoolYear added!")})).catch((function(n){return e.status(400).json("Error: "+n)}))})).catch((function(n){return e.status(400).json("Error: "+n)}))})),r.route("/addSubject/:id/:year").put((function(n,e){var t={title:n.body.title,slug:n.body.slug,teacher:n.body.teacher,ratingsFirstHalf:[],rateFirstHalf:"",ratingsSecondHalf:[],rateSecondHalf:"",rateForYear:""};o.findById(n.params.id).then((function(r){r.schoolYears.map((function(e){e.yearFrom===n.params.year&&e.subjects.push(t)})),r.save().then((function(){return e.json(t)})).catch((function(n){return e.status(400).json("Error: "+n)}))})).catch((function(n){return e.status(400).json("Error: "+n)}))})),r.route("/deleteSchoolYear/:id").put((function(n,e){o.findById(n.params.id).then((function(t){t.schoolYears.filter(n.body.schoolYear),t.save().then((function(){return e.json("User's schoolYear added!")})).catch((function(n){return e.status(400).json("Error: "+n)}))})).catch((function(n){return e.status(400).json("Error: "+n)}))})),n.exports=r},348:function(n,e,t){var r=t(52),o=new(0,r.Schema)({username:{type:String,unique:!0,trim:!0,minlength:3},password:{type:String,trim:!0,minlength:3},name:{type:String,required:!0,trim:!0,minlength:3},secondName:{type:String,required:!0,trim:!0,minlength:3},familyName:{type:String,required:!0,trim:!0,minlength:3},email:{type:String,unique:!0,trim:!0,minlength:3},phone:{type:String,unique:!0,trim:!0,minlength:3},isAdmin:{type:Boolean,required:!0},schoolYears:{type:Array}},{timestamps:!0}),s=r.model("User",o);n.exports=s},349:function(n,e,t){var r=t(52),o=new(0,r.Schema)({yearId:{type:String,trim:!0},teacherId:{type:String,trim:!0},grade:{type:String,required:!0,trim:!0},subGrade:{type:String,required:!0,trim:!0}},{timestamps:!0}),s=r.model("Grade",o);n.exports=s},350:function(n,e,t){var r=t(351);n.exports=function(n,e,t){var o=n.header("Bearer Token");if(!o)return e.status(401).json({msg:"No token, authorizaton denied"});try{var s=r.verify(o,"somesecretkeyforjsonwebtoken");n.user=s,t()}catch(i){e.status(400).json({msg:"Token is not valid"})}}},368:function(n,e,t){"use strict";t.r(e),function(n){var e=t(156),r=t(157),o=function(){function n(){Object(e.a)(this,n)}return Object(r.a)(n,null,[{key:"getDate",value:function(){return(new Date).toLocaleString()}},{key:"setColor",value:function(n,e){return e+n+"\x1b[0m"}},{key:"info",value:function(e){var t=n.getDate();console.log(n.setColor("["+t+"]","\x1b[36m"),e)}},{key:"error",value:function(e){var t=n.getDate();console.log(n.setColor("["+t+"]","\x1b[31m"),n.setColor(e,"\x1b[31m"))}},{key:"rawError",value:function(e){var t=n.getDate();console.log(n.setColor("["+t+"]","\x1b[31m"),e)}},{key:"warning",value:function(e){var t=n.getDate();console.log(n.setColor("["+t+"]","\x1b[33m"),n.setColor(e,"\x1b[33m"))}},{key:"success",value:function(e){var t=n.getDate();console.log(n.setColor("["+t+"]","\x1b[32m"),n.setColor(e,"\x1b[32m"))}}]),n}();n.exports.info=o.info,n.exports.error=o.error,n.exports.rawError=o.rawError,n.exports.warning=o.warning,n.exports.success=o.success}.call(this,t(369)(n))},76:function(n,e,t){"use strict";(function(e){var t="production";n.exports={isProduction:!0,isDevelopment:!1,isTest:!1,env:t,vars:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}),basePath:e.cwd()}}).call(this,t(3))}},[[158,1,2]]]);
//# sourceMappingURL=main.fb54058f.chunk.js.map